# MimtPy
MIami Multi Track tools in Python  
MimtpyApp works based on the S1***.he5, exclude_data.txt and inputs floder generated by Mintpy.

## Installation:
Test only on Linux, not sure about MacOS and Windows

### 1. Download and setup
Run the following in your terminal to download the development version of MimiPy

`cd rsmas_insar/source/`  
`git clone https://github.com/geodesymiami/mimtpy.git  `

Seting the following environment variables in your environment.bash

'export MIMTPY_HOME=${RSMASINSAR_HOME}/sources/MimtPy'
`export PYTHONPATH=${PYTHONPATH}:${MIMTPY_HOME}`
`export PATH=${PATH}:${MIMTPY_HOME}/mimtpy` 

### 2. the packages used in MimtPy that should be installed

#### via conda
rasterio  
geopandas  
osgeo  

#### these two packages installation is complex, we recommend not install them use conda but following their handbook
pyrocko  
Kite  

## the Pre-requirement of MimtPy

The folder structure of MintPy product should be:  

`$SCRATCHDIR---Project1---mintpy---S1***.he5 & inputs--geometryRadar.h5`

## Folder structure after runing mimtpyApp.py:

`$SCRATCHDIR---Project1---mintpy---S1***.he5 & inputs---geometryRadar.h5 & velocity---velocity_date1_date2.h5 & displacement---displacement_date1_date2.h5`

## The composition of MimtPy
### Basic module

mimtpyApp.py: generate files according to mimtpyApp.template 

plot_geotiff.py: plot geotiff files with given *.shp files and gps velocity vector field. Now the *.shp files are fault trace and reference point. The shp files must be given or people can use view.py script to draw picture based on the above *.h5 files.The gps site are now from NGLStation dataset.We are working on other gps dataset.

HDFEOS_to_geotiff.py: transferring S1**.he5 file into *.h5 and *.geotiff files based on given dataset name.

### Analysis module

track_offsets.py: estimating a constant offset as the median of the differences of the overlapping areas. After adjusting the adjacent tracks, concatenating the two tracks using average value in overlaying area.

multi_transects.py: Extract data along the profiles which are perpendicular to the fault

overlap2horz_vert.py: Calculate horizontal and vertical value from the overlap region between adjacent tracks

### Tool module

H5UNW_to_geotiff.py: transferring *.unw or *.h5 file into geotiff file.

generate_track_polygon.py: Get the footprint scene of each project  

synthetic_S1.py: simulate linear ramps

### Preprocess module

save_geodmod.py: generate files used by Geodmod software.

save_kite.py: generate Kite scene using HDFEOS data.

save_insamp.py: prepare data for Barnhart's InSAMP software (written in Matlab). Please note that the data used by this script must be geocoded.

### RELAX module
generate_script_RELAX_V2.py: generate template files for RELAX. People must given one example file.

gridsearch_ramps_batch_relax: doing gridseach batchlly

gridsearch_ramps_relax: doing gridsearch for one pair of parameter

## Access to mintpy data products
Browse through all directories using: https://129.114.104.223/data/HDF5EOS 

Get them via wget using:
```
wget -r -nH --cut-dirs=2 --no-parent --reject="index.html*" --no-check-certificate https://129.114.104.223/data/HDF5EOS/unittestGalapagosSenDT128/mintpy
```
If you have access to jetstream and  your public key is added in the .ssh directory:
```
scp -rp centos@129.114.104.223:/data/HDF5EOS/KashgarSenAT129 .
```
## links to software packages

for Kite:
git clone https://github.com/pyrocko/kite.git

for InSAMP:
git clone https://github.com/williamBarnhart/InSamp.git
